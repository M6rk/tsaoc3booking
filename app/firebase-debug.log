[debug] [2025-08-30T05:23:52.894Z] ----------------------------------------------------------------------
[debug] [2025-08-30T05:23:52.898Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\markl\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js deploy
[debug] [2025-08-30T05:23:52.898Z] CLI Version:   14.4.0
[debug] [2025-08-30T05:23:52.898Z] Platform:      win32
[debug] [2025-08-30T05:23:52.899Z] Node Version:  v20.11.1
[debug] [2025-08-30T05:23:52.899Z] Time:          Fri Aug 29 2025 22:23:52 GMT-0700 (Pacific Daylight Time)
[debug] [2025-08-30T05:23:52.899Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-08-30T05:23:53.211Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-08-30T05:23:53.211Z] > authorizing via signed-in user (mark.lovesey@salvationarmy.ca)
[debug] [2025-08-30T05:23:53.211Z] [iam] checking project tsaoc3booking for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get","firebasehosting.sites.update"]
[debug] [2025-08-30T05:23:53.213Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:53.213Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:53.214Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/tsaoc3booking:testIamPermissions [none]
[debug] [2025-08-30T05:23:53.214Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/tsaoc3booking:testIamPermissions x-goog-quota-user=projects/tsaoc3booking
[debug] [2025-08-30T05:23:53.214Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tsaoc3booking:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get","firebasehosting.sites.update"]}
[debug] [2025-08-30T05:23:53.434Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/tsaoc3booking:testIamPermissions 200
[debug] [2025-08-30T05:23:53.435Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tsaoc3booking:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get","firebasehosting.sites.update"]}
[debug] [2025-08-30T05:23:53.435Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:53.435Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:53.436Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/tsaoc3booking [none]
[debug] [2025-08-30T05:23:53.822Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/tsaoc3booking 200
[debug] [2025-08-30T05:23:53.822Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/tsaoc3booking {"projectId":"tsaoc3booking","projectNumber":"352478998941","displayName":"TSAOC3Booking","name":"projects/tsaoc3booking","resources":{"hostingSite":"tsaoc3booking"},"state":"ACTIVE","etag":"1_066ac5c8-3f1e-4223-ac2f-cd38a3c495ff"}
[debug] [2025-08-30T05:23:53.824Z] Specified "public" directory "build" does not exist; Deploy to Hosting site "tsaoc3booking" may fail or be empty.
[info] 
[info] === Deploying to 'tsaoc3booking'...
[info] 
[info] i  deploying firestore, hosting 
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-08-30T05:23:53.829Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:53.829Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:53.830Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/tsaoc3booking:test [none]
[debug] [2025-08-30T05:23:53.830Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/tsaoc3booking:test [omitted]
[debug] [2025-08-30T05:23:54.016Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/tsaoc3booking:test 200
[debug] [2025-08-30T05:23:54.016Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/tsaoc3booking:test {}
[info] +  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-08-30T05:23:54.021Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:54.021Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:54.022Z] >>> [apiv2][query] POST https://firebasehosting.googleapis.com/v1beta1/projects/-/sites/tsaoc3booking/versions [none]
[debug] [2025-08-30T05:23:54.022Z] >>> [apiv2][body] POST https://firebasehosting.googleapis.com/v1beta1/projects/-/sites/tsaoc3booking/versions {"status":"CREATED","labels":{"deployment-tool":"cli-firebase"}}
[debug] [2025-08-30T05:23:54.813Z] <<< [apiv2][status] POST https://firebasehosting.googleapis.com/v1beta1/projects/-/sites/tsaoc3booking/versions 200
[debug] [2025-08-30T05:23:54.813Z] <<< [apiv2][body] POST https://firebasehosting.googleapis.com/v1beta1/projects/-/sites/tsaoc3booking/versions {"name":"projects/352478998941/sites/tsaoc3booking/versions/2cb1f78f6cc3a373","status":"CREATED","config":{},"labels":{"deployment-tool":"cli-firebase"}}
[debug] [2025-08-30T05:23:54.815Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:54.815Z] Checked if tokens are valid: true, expires at: 1756534310345
[info] i  firestore: deploying indexes... 
[debug] [2025-08-30T05:23:54.817Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:54.817Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:54.818Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/releases pageSize=10&pageToken=
[debug] [2025-08-30T05:23:54.819Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/tsaoc3booking/databases/(default)/collectionGroups/-/indexes [none]
[debug] [2025-08-30T05:23:55.126Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/releases 200
[debug] [2025-08-30T05:23:55.126Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/releases {"releases":[{"name":"projects/tsaoc3booking/releases/cloud.firestore","rulesetName":"projects/tsaoc3booking/rulesets/c7449ce4-477c-403c-8b92-bc534f5d3e43","createTime":"2025-08-11T17:19:22.716086Z","updateTime":"2025-08-28T23:03:46.585205Z"}]}
[debug] [2025-08-30T05:23:55.126Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:55.126Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:55.127Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/rulesets/c7449ce4-477c-403c-8b92-bc534f5d3e43 [none]
[debug] [2025-08-30T05:23:55.222Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/tsaoc3booking/databases/(default)/collectionGroups/-/indexes 200
[debug] [2025-08-30T05:23:55.223Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/tsaoc3booking/databases/(default)/collectionGroups/-/indexes {"indexes":[{"name":"projects/tsaoc3booking/databases/(default)/collectionGroups/vehicleBookings/indexes/CICAgJim14AK","queryScope":"COLLECTION","fields":[{"fieldPath":"date","order":"DESCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/tsaoc3booking/databases/(default)/collectionGroups/roomBookings/indexes/CICAgOjXh4EK","queryScope":"COLLECTION","fields":[{"fieldPath":"date","order":"DESCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"}]}
[debug] [2025-08-30T05:23:55.223Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:55.223Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:55.224Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/tsaoc3booking/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* [none]
[debug] [2025-08-30T05:23:55.234Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/rulesets/c7449ce4-477c-403c-8b92-bc534f5d3e43 200
[debug] [2025-08-30T05:23:55.234Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/rulesets/c7449ce4-477c-403c-8b92-bc534f5d3e43 [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-08-30T05:23:55.236Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:55.236Z] Checked if tokens are valid: true, expires at: 1756534310345
[debug] [2025-08-30T05:23:55.236Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/rulesets [none]
[debug] [2025-08-30T05:23:55.236Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/rulesets [omitted]
[debug] [2025-08-30T05:23:55.341Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/tsaoc3booking/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* 200
[debug] [2025-08-30T05:23:55.342Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/tsaoc3booking/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* {"fields":[{"name":"projects/tsaoc3booking/databases/(default)/collectionGroups/__default__/fields/*","indexConfig":{"indexes":[{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"ASCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"DESCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","arrayConfig":"CONTAINS"}],"state":"READY"}]}}]}
[info] i  firestore: The following indexes are defined in your project but are not present in your firestore indexes file:
	(vehicleBookings) -- (date,DESCENDING) (createdAt,DESCENDING) 
	(roomBookings) -- (date,DESCENDING) (createdAt,DESCENDING)  
[debug] [2025-08-30T05:23:55.376Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/rulesets 200
[debug] [2025-08-30T05:23:55.376Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/tsaoc3booking/rulesets {"name":"projects/tsaoc3booking/rulesets/4e16124f-01b9-41f7-9cd1-396f478266a5","source":{"files":[{"content":"rules_version = '2';\r\nservice cloud.firestore {\r\n  match /databases/{database}/documents {\r\n    // Helper function to check if user is admin\r\n    function isAdmin() {\r\n      return request.auth != null && \r\n        (request.auth.token.email == \"admin@salvationarmy.ca\" ||\r\n         request.auth.token.email == \"oc3admin@sa.ca\");\r\n    }\r\n    \r\n    // Helper function to check if user has valid SA email\r\n    function isValidUser() {\r\n      return request.auth != null && \r\n        request.auth.token.email.matches(\".*@salvationarmy\\\\.ca$\");\r\n    }\r\n    \r\n    // Users collection - allow authenticated SA users to read any user profile\r\n    match /users/{userId} {\r\n      allow read: if isValidUser(); // Allow any SA user to read profiles\r\n      allow write: if isAdmin(); // Only admin can write\r\n    }\r\n    \r\n    // Room bookings - all authenticated SA users can read/write\r\n    match /roomBookings/{bookingId} {\r\n      allow read, write: if isValidUser();\r\n    }\r\n    \r\n    // Vehicle bookings - all authenticated SA users can read/write\r\n    match /vehicleBookings/{bookingId} {\r\n      allow read, write: if isValidUser();\r\n    }\r\n  }\r\n}","name":"firestore.rules"}]},"createTime":"2025-08-30T05:24:00.267535Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-08-30T05:23:55.376Z] [rules] created ruleset projects/tsaoc3booking/rulesets/4e16124f-01b9-41f7-9cd1-396f478266a5
[debug] [2025-08-30T05:24:38.369Z] ExitPromptError: User force closed the prompt with SIGINT
    at Interface.sigint (C:\Users\markl\AppData\Roaming\npm\node_modules\firebase-tools\node_modules\@inquirer\core\dist\commonjs\lib\create-prompt.js:101:37)
    at Interface.emit (node:events:518:28)
    at Interface.emit (node:domain:488:12)
    at [_ttyWrite] [as _ttyWrite] (node:internal/readline/interface:1125:18)
    at ReadStream.onkeypress (node:internal/readline/interface:264:20)
    at ReadStream.emit (node:events:530:35)
    at ReadStream.emit (node:domain:488:12)
    at emitKeys (node:internal/readline/utils:371:14)
    at emitKeys.next (<anonymous>)
    at ReadStream.onData (node:internal/readline/emitKeypressEvents:64:36)
[error] 
[error] Error: An unexpected error has occurred.
